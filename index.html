<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>AI Assistant</title>

<!-- Bot Framework Web Chat -->
<script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js"></script>

<style>
/* FULL SCREEN RESET */
html, body {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #ffffff;
    font-family: Arial, sans-serif;
}

/* WEBCHAT CONTAINER */
#webchat {
    width: 100vw;
    height: 100vh;
}

/* =========================
   âœ… CHAT BUBBLE FIXES
   ========================= */

/* Force assistant bubbles to use screen width */
.webchat__bubble {
    max-width: 96% !important;
}

/* Stretch bubble content */
.webchat__bubble__content {
    width: 100%;
}

/* =========================
   âœ… TABLE FIXES
   ========================= */

.webchat__bubble table {
    width: 100% !important;
    table-layout: fixed;
    border-collapse: collapse;
}

/* Table headers & cells */
.webchat__bubble th,
.webchat__bubble td {
    padding: 8px 12px;
    border: 1px solid #d0d7e2;
    text-align: left;
    vertical-align: middle;
    white-space: nowrap;       /* KEEP SINGLE LINE */
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Header styling */
.webchat__bubble th {
    background-color: #e6f0ff;
    font-weight: bold;
}

/* Optional wrap class for long text */
.webchat__bubble td.wrap {
    white-space: normal;
}

/* Improve row spacing */
.webchat__bubble tr {
    line-height: 1.4;
}

/* =========================
   âœ… MOBILE SCROLL SAFETY
   ========================= */

.webchat__bubble table {
    display: block;
    overflow-x: auto;
    max-width: 100%;
}
</style>
</head>

<body>

<div id="webchat"></div>

<script>
(async function () {
    const tokenRes = await fetch("https://92090669134ce372b182b6f53013f4.0b.environment.api.powerplatform.com/powervirtualagents/botsbyschema/crbf0_agent2_uPuGjw/directline/token?api-version=2022-03-01-preview");
    const { token } = await tokenRes.json();

    const styleOptions = {
        backgroundColor: "#ffffff",

        /* ðŸ”‘ THIS FIXES WIDTH ISSUES */
        bubbleMaxWidth: 1200,

        /* Assistant messages */
        bubbleBackground: "#F0F6FF",
        bubbleBorderRadius: 14,

        /* User messages */
        bubbleFromUserBackground: "#FFFFFF",
        bubbleFromUserBorderRadius: 14,

        primaryFont: "Arial",
        fontSizeSmall: "14px",
        fontSizeMedium: "16px",
        fontSizeLarge: "18px"
    };

    window.WebChat.renderWebChat(
        {
            directLine: window.WebChat.createDirectLine({ token }),
            styleOptions
        },
        document.getElementById("webchat")
    );
})();
</script>

</body>
</html>
